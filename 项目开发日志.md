# 项目开发日志

## 目录

- [项目介绍](#项目介绍)

  - [项目技术栈](#项目技术栈)

- [项目设计](#项目设计)

  - [页面设计](#页面设计)

  - [组件设计](#组件设计)

- [Q\&A](#qa)

  - [配置 src 别名](#配置src别名)

  - [组件骨架](#组件骨架)

  - [使用 sass](#使用sass)

  - [毛玻璃效果](#毛玻璃效果)

  - [快速创建首元素为 0, 长度为 n 的数组](#快速创建首元素为0-长度为n的数组)

  - [常用 git 命令](#常用git命令)

# 项目介绍

> 本项目旨在重构一个功能更简洁, UI 更美观的网页版第三方网易云音乐播放器

## 项目技术栈

- 项目构建工具: `CRA` & `craco`

- 用户界面框架: `React18`&#x20;

- 开发语言: `TypeScript`

- 样式语言: `SASS`

- 状态管理: `MobX6`&#x20;

- 路由: `React Router v6`

- UI 组件库: `Material UI`

- 网络请求: `Axios`

- 项目管理: `Git`

# 项目设计

## 页面设计

| 页面名       | 页面描述     | 父组件 | 对应路由              |
| ------------ | ------------ | ------ | --------------------- |
| App          | 应用根页面   | null   | /                     |
| Recommend    | 推荐页       | App    | /, /recommend         |
| Category     | 分类页       | App    | /category             |
| Personalize  | 个性化页     | App    | /personalize          |
| Login        | 登录页       | App    | /login                |
| Setting      | 设置页       | App    | /setting              |
| Playlist     | 歌单展示页   | (公共) | /playlist/:playlistId |
| Album        | 专辑展示页   | (公共) | /album/:albumId       |
| Artist       | 歌手展示页   | (公共) | /artist/:artistId     |
| SearchResult | 搜索结果展示 | App    | /search/:searchKey    |

## 组件设计

| 组件名          | 组件描述         | 父组件                           | props                               |     |     |
| --------------- | ---------------- | -------------------------------- | ----------------------------------- | --- | --- |
| TopAppBar       | 页面登录导航栏   | App                              | 无                                  |     |     |
| BottomAppBar    | 音乐播放控制栏   | App                              | 播放列表, 循环模式, 音量,           |     |     |
| PlaylistExhibit | 歌单横向展示组件 | Recommend, Category, Personalize | 要展示的歌单列表, 以数组形式传入    |     |     |
| PlaylistCard    | 单个歌单展示卡片 | PlaylistExhibit                  | 歌单 id, 歌单名, 歌单封面, 歌单描述 |

# Q\&A

## 配置 src 别名

1.  安装 CRA 配置库` @craco/craco``yarn add @craco/craco `

2.  package.json 中应生成: `"@craco/craco": "^6.1.1"`

3.  根目录创建`craco.config.js`

    ```json
    // craco.config.js
    const path = require('path')

    const pathResolve = (pathUrl) => path.join(__dirname, pathUrl)

    module.exports = {
      webpack: {
        alias: {
          '@@': pathResolve('.'),
          '@': pathResolve('src'),
        },
      },
    }

    ```

4.  修改`tsconfig.json`

    ```json
    {
      "compilerOptions": {
      ...
      "paths": {
          "@/*": ["src/*"]
      },
    }
    ```

## 组件骨架

当组件未加载完成时需要显示在页面上的骨架. 定义在每个组件中作为可导出项

例:

```react tsx
export default const PlaylistCard = () => {
  const navigate = useNavigate()

  const handleClickPlaylist = (id: number) => {
    const res = navigate(`/playlist/${id}`)
    console.log(res)
  }

  return (
    <Card sx={{ maxWidth: 185 }}>
      <CardActionArea onClick={() => handleClickPlaylist(id)}>
        <CardMedia component='img' image={picUrl} alt={name}></CardMedia>
      </CardActionArea>

      <CardContent>
        <TypographyLink />
      </CardContent>
    </Card>
  )
}

export const PlaylistCardSkeleton = () => {
  return (
    <Card sx={{ maxWidth: 185 }}>
      <CardActionArea>
        <Skeleton variant='rectangular' width='100%'>
          <div style={{ paddingTop: '125%' }} />
        </Skeleton>
      </CardActionArea>
    </Card>
  )
}

```

## 使用 sass

CRA 的 webpack 默认支持了`sass-loader`, 因此只需安装`sass`即可

`yarn add sass`

## 毛玻璃效果

```css
.FrostedGlass {
  background-color: rgba(255, 255, 255, 0.7);
  backdrop-filter: saturate(180%) blur(25px);
}
```

## 快速创建首元素为 0, 长度为 n 的数组

`[...(new Array(n).keys())]`

## 常用 git 命令

- 始化本地仓库`git init`

- 临时存储代码到工作区`git add <filename>` or `git add -A`

- 提交代码到本地仓库`git commit -m '[提交信息]'`

- 创建并切换分支 git checkout -b newBranch

- 查看所有分支`git branch -a`

- 删除本地分支`git branch -d <branch-name>`

- 创建远程仓库别名`git remote add <origin-name> git@github.com:nahuaqiao/cms-ui.git`

- 删除远程仓库及别名`git remote rm <origin-name>`

- 查看远程仓库列表`git remote -v`

- 推送远程仓库到 github`git push origin-name <local-branch-name>: <github-branch-name>`

- 若第一次推送时加上-u 参数, 则指定 origin-name 为默认主机, 之后直接使用 git push 即可

## github 警告

> We found potential security vulnerabilities in your dependencies.
> https://martellosecurity.com/kb/mitre/cwe/1333/
